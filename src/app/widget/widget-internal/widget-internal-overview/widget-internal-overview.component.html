
<div class="order-details__wrapper">
    <div class="order-details__content order-details__content--first">

        <div class="__widget-title-container__ m-0">
            <div class="__widget-title-logo-container">
                <!-- logoSrc -->
              <img class="__widget-title-logo" [src]="'https://app.getcoins.com.au/images/logo-widget.png'" [alt]="logoAlt" width="160">
            </div>
        </div>

        <form [formGroup]="dataForm">
            <app-widget-input-group 
                [label]="spendTitle" 
                [boxFieldName]="'amountSpend'"
                [boxField]="amountSpendField" 
                [comboField]="currencySpendField" 
                [comboFieldName]="'currencySpend'"
                [comboList]="spendCurrencyList" 
                [errorMessages]="amountSpendErrorMessages">
            </app-widget-input-group>
    
            <app-widget-input-group 
                [label]="receiveTitle" 
                [boxFieldName]="'amountReceive'"
                [boxField]="amountReceiveField" 
                [comboField]="currencyReceiveField" 
                [comboFieldName]="'currencyReceive'"
                [comboList]="receiveCurrencyList" 
                [errorMessages]="amountReceiveErrorMessages">
            </app-widget-input-group>
    
            <div *ngIf="!settings.embedded" class="mt-3">
                <app-widget-rate 
                    class="__widget-rate-container" 
                    [currencySpend]="currencySpendField.value"
                    [currencyReceive]="currencyReceiveField.value" 
                    [showRate]="settings.showRate !== false" 
                    [rate]="summary?.rate">
                </app-widget-rate>
            </div>
    
            <div class="order-details__container mt-3">
                <div class="order-details__header">
                  <span class="order-details__header-title">
                    {{amountSpendField.valid ? amountSpendField.value : ''}} {{currencySpendField?.value || ''}} 
                    <span>- is all you pay, fees included</span>
                  </span>
                  <button type="button" class="order-details__header-button" (click)="mobileSummary = !mobileSummary">{{!mobileSummary ? 'Details' : 'Hide'}} </button>
                </div>
                <div *ngIf="mobileSummary">
                    <hr class="order-details__divider mb-2">
    
                    <div class="order-details__item">
                      <span class="order-details__item-label">Transaction</span>
                      <span class="order-details__item-value">{{summary?.transaction}}</span>
                    </div>
    
                    <div class="order-details__item">
                        <span class="order-details__item-label">Spend</span>
                        <span class="order-details__item-value">{{summary?.amountFrom?.toFixed(summary?.amountFromPrecision) || 0}} {{summary?.currencyFrom}}</span>
                    </div>
    
                    <div class="order-details__item">
                        <span class="order-details__item-label">Receive</span>
                        <span class="order-details__item-value">{{summary?.amountTo?.toFixed(summary?.amountToPrecision) || 0}} {{summary?.currencyTo}}</span>
                    </div>
        
                    <div class="order-details__item">
                        <span class="order-details__item-label">Exchange rate</span>
                        <span class="order-details__item-value">{{summary?.rate || '-'}}</span>
                    </div>
        
                    <div class="order-details__item" *ngIf="summary?.fee > 0">
                        <span class="order-details__item-label"> eWallet fees</span>
                        <span class="order-details__item-value"> {{summary?.transactionFee}} {{summary?.transactionFeeCurrency}}</span>
                    </div>
        
                    <div class="order-details__item" *ngIf="summary?.networkFee > 0">
                        <span class="order-details__item-label"> Network fees</span>
                        <span class="order-details__item-value"> {{summary?.networkFee}} {{summary?.networkFeeCurrency}}</span>
                    </div>
                </div>
            </div>

           <ng-container *ngIf="isSinglePage">
                <div class="mt-3">
                    <app-form-textbox 
                        [placeholder]="'Email'" 
                        [maxlength]="50"
                        formControlName="email" 
                        [errorMessages]="emailErrorMessages" 
                        [separator]="true">
                    </app-form-textbox>

                    <app-form-textbox *ngIf="showWallet"
                        [placeholder]="'Wallet address'" 
                        [maxlength]="120" formControlName="wallet"
                        [errorMessages]="walletErrorMessages" >
                    </app-form-textbox>

                    <div *ngIf="walletField?.hasError('walletAddress')" class="__form-assist __form-assist-error">
                        Wallet address is not valid
                    </div>
                </div>
           </ng-container>
    
            <div class="button-proceed-wrapper" *ngIf="hideProceedButton">
                <span class="order-details__overview-terms" *ngIf="isSinglePage">Continuing, you agree to 
                    <a [href]="termsLink" target="_blank">Terms of Service</a> and 
                    <a [href]="privacyLink" target="_blank">Privacy Policy</a>
                </span>
                <button type="button" [disabled]="!isOrderProceedFormValid" (click)="onProceed()">
                    Proceed <span class="tx-30">&#183;</span> Total {{amountSpendField.valid ? amountSpendField.value : '---'}}
                </button>
            </div>
        </form>
    
        <div class="__widget-data-error">
            {{errorMessageData}}
        </div>

        <ng-container *ngIf="!summary?.rate">
			<app-spinner></app-spinner>
		</ng-container>
    </div>

    <div class="order-details__content order-details__content--second" 
        [class.order-details__content--active]="isSecondPartActive && !isOrderDetailsComplete" 
        [ngClass]="isSecondPartActive && !isOrderDetailsComplete ? 'd-flex' : 'd-none'" >
        <form class="order-details__overview" [formGroup]="dataForm">
          <div class="order-details__overview-details">
            <h3 class="order-details__overview-title">Order Details</h3>
            <div class="order-details__overview-details-item">
                <app-form-textbox 
                    [label]="'Email'" 
                    [maxlength]="50"
                    formControlName="email" 
                    [errorMessages]="emailErrorMessages" 
                    [separator]="true">
                </app-form-textbox>
            
                <app-form-textbox 
                    *ngIf="showWallet"
                    [label]="'Wallet address'" 
                    [maxlength]="120" formControlName="wallet"
                    [errorMessages]="walletErrorMessages" >
                </app-form-textbox>
        
                <div *ngIf="walletField?.hasError('walletAddress')" class="__form-assist __form-assist-error">
                    Wallet address is not valid
                </div>
            </div>
          </div>
          <span class="order-details__overview-terms">Continuing, you agree to 
            <a [href]="termsLink" target="_blank">Terms of Service</a> and 
            <a [href]="privacyLink" target="_blank">Privacy Policy</a>
          </span>
          <div class="order-details__overview-actions">
            <button type="button" class="order-details__overview-actions--back" (click)="onCancel()">Back </button>
            <button type="button" class="order-details__overview-actions--next" (click)="onSubmit()" [disabled]="!isOrderDetailsFormValid">Next </button>
          </div>
      </form>
    </div>
</div>
