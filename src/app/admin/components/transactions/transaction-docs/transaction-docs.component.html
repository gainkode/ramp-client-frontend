<div  class="w-500px">
  <mat-card-header class="pd-10-f">
    <mat-card-title>Signature</mat-card-title>
  </mat-card-header>

  <div class="inputs-wrap" [formGroup]="form">
    <mat-form-field appearance="outline" class="size-wider">
      <mat-label>Status</mat-label>
      <mat-select appendTo="body" formControlName="status">
        <mat-option *ngFor="let status of signatureStatuses" [value]="status">
          {{ status }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <fieldset *ngIf="!isSignatureAdd">
      <mat-form-field appearance="outline" class="size-wider">
        <mat-label>Created</mat-label>
        <input matInput type="text" formControlName="createdAt" [readonly]="true"/>
      </mat-form-field>
  
      <mat-form-field appearance="outline" class="size-smaller">
        <mat-label>Executed</mat-label>
        <input matInput type="text" formControlName="executedAt" [readonly]="true"/>
      </mat-form-field>
    </fieldset>
    
    <app-file-upload *ngIf="isSignatureAdd" [multiple]="true" (fileSelected)="onFileSelected($event)"></app-file-upload>

    <div class="create_docs-buttons">    
      <button class="btn btn-primary wd-100" type="button" [disabled]="!form.valid || !isFileUploaded || uploadProgress" (click)="onSave()">
        {{ !uploadProgress ? 'Save' : ''}}
        <span *ngIf="uploadProgress" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
      </button>
    </div>

  </div>
</div>

<!-- <button class="btn btn-primary mg-t-10 mg-b-10 tx-14" type="button" (click)="onAddDocument()">Add Document</button> -->

<div class="docs-wrapper w-500px pd-b-20-f" [class.emptyData]="!tableDataSource.data.length">
  <mat-card-header class="pd-10-f">
    <mat-card-title>Signature Documents</mat-card-title>
  </mat-card-header>
  
  <app-table
    [dataSource]="tableDataSource" 
    [withDetails]="true"
    [columns]="config"
    (expandDetail)="showDetail($event)">
    <ng-container matColumnDef="...">
      <th *matHeaderCellDef mat-header-cell>Actions</th>
      <td *matCellDef="let row" mat-cell>
        <div class="flex">
          <button
            type="button"
            class="action-button"
            (click)="onFileDownload(row)">
            <i class="fas fa-download"></i>
          </button>

          <button
            type="button"
            class="action-button"
            (click)="onFileRemove(row)">
            <i class="fas fa-trash"></i>
          </button>
        </div>
      </td>
    </ng-container>

    <ng-container matColumnDef="expandedDetail">
      <td *matCellDef="let element" mat-cell [attr.colspan]="config.length">
        <div class="cell-detail" [@detailExpand]="element === expandedElement ? 'expanded' : 'collapsed'">
          <app-signtature-doc-details [signatureDocument]="element"></app-signtature-doc-details>
        </div>
      </td>
    </ng-container>
  </app-table>
</div>

<ng-container *ngIf="isLoading$ | async">
  <app-spinner></app-spinner>
</ng-container>