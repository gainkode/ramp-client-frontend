<app-filter-panel [fields]="filterFields" (filter)="handleFilterApplied($event)"></app-filter-panel>

<div class="action-panel">
    <button mat-flat-button color="primary" [disabled]="selectedItem && !selectedItem.id" (click)="createNewWidget()">
        ADD WIDGET
    </button>
</div>

<div class="data-table">
    <mat-table matSort matSortDirection="desc" matSortDisableClear [matSortActive]="sortedField" [dataSource]="data">

        <!-- Details Column -->
        <ng-container matColumnDef="details" sticky>
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element">
                <button mat-icon-button class="row-button" (click)="toggleDetails(element)"
                    [attr.aria-label]="'Widget details'" [attr.aria-pressed]="!!selectedItem"
                    [matTooltip]="getDetailsTooltip(element.id)" matTooltipClass="info-tooltip">
                    <mat-icon class="details-icon">{{getDetailsIcon(element.id)}}</mat-icon>
                </button>
            </td>
        </ng-container>

        <!-- <ng-container matColumnDef="user">
            <th mat-header-cell *matHeaderCellDef>User</th>
            <td mat-cell *matCellDef="let element"> {{element.user}} </td>
        </ng-container> -->

        <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef>Name</th>
            <td mat-cell *matCellDef="let element"> {{element.name}} </td>
        </ng-container>

        <ng-container matColumnDef="created">
            <th mat-header-cell *matHeaderCellDef>Created at</th>
            <td mat-cell *matCellDef="let element"> {{element.created}} </td>
        </ng-container>

        <ng-container matColumnDef="transactionType">
            <th mat-header-cell *matHeaderCellDef>Transaction Type</th>
            <td mat-cell *matCellDef="let element"> {{element.transactions?.join(', ')}} </td>
        </ng-container>


        <ng-container matColumnDef="currenciesFrom">
            <th mat-header-cell *matHeaderCellDef>Currencies From</th>
            <td mat-cell *matCellDef="let element"> {{element.currenciesFrom?.join(', ')}} </td>
        </ng-container>


        <ng-container matColumnDef="currenciesTo">
            <th mat-header-cell *matHeaderCellDef>Currencies to</th>
            <td mat-cell *matCellDef="let element"> {{element.currenciesTo?.join(', ')}} </td>
        </ng-container>


        <ng-container matColumnDef="destinationAddress">
            <th mat-header-cell *matHeaderCellDef>Destination address</th>
            <td mat-cell *matCellDef="let element"> {{element.destinationAddress}} </td>
        </ng-container>


        <ng-container matColumnDef="userNotificationId">
            <th mat-header-cell *matHeaderCellDef>User notification Id</th>
            <td mat-cell *matCellDef="let element"> {{element.userNotificationId}} </td>
        </ng-container>


        <ng-container matColumnDef="countries">
            <th mat-header-cell *matHeaderCellDef>Countries</th>
            <td mat-cell *matCellDef="let element"> {{element.countries?.join(', ')}} </td>
        </ng-container>

        <ng-container matColumnDef="instruments">
            <th mat-header-cell *matHeaderCellDef>Payment Methods</th>
            <td mat-cell *matCellDef="let element"> {{element.instruments?.join(', ')}} </td>
        </ng-container>

        <ng-container matColumnDef="paymentProviders">
            <th mat-header-cell *matHeaderCellDef>Payment providers</th>
            <td mat-cell *matCellDef="let element"> {{element.paymentProviders?.join(', ')}} </td>
        </ng-container>

        <ng-container matColumnDef="liquidityProvider">
            <th mat-header-cell *matHeaderCellDef>Liquidity provider</th>
            <td mat-cell *matCellDef="let element"> {{element.liquidityProvider}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </mat-table>

</div>

<mat-paginator [length]="customerCount" [pageSize]="pageSize" [pageSizeOptions]="[25, 50, 100]" showFirstLastButtons
    (page)="handlePage($event)">
</mat-paginator>

<ng-template *ngIf="selectedItem" appRightPanel>
    <app-widget-editor
        [widget]="selectedItem">
    </app-widget-editor>
</ng-template>
