<app-filter-panel [fields]="filterFields" (filter)="handleFilterApplied($event)"></app-filter-panel>

<div class="data-table">
    <mat-table matSort [matSortActive]="sortedField" matSortDirection="desc" matSortDisableClear [dataSource]="wallets">

        <ng-container matColumnDef="details" sticky>
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element">
                <button mat-icon-button class="row-button" (click)="toggleDetails(element)"
                    [attr.aria-label]="'Transaction details'" [attr.aria-pressed]="!!selectedWallet"
                    [matTooltip]="getDetailsTooltip(element.id)" matTooltipClass="info-tooltip">
                    <mat-icon class="details-icon">{{getDetailsIcon(element.id)}}</mat-icon>
                </button>
                <button *ngIf="element.custodyProviderLink!==''" mat-icon-button class="row-button"
                    (click)="showCustodyProvider(element.custodyProviderLink)" [attr.aria-label]="'Wallet details'"
                    [matTooltip]="'Wallet details'" matTooltipClass="info-tooltip">
                    <mat-icon class="details-icon">
                        account_balance_wallet
                    </mat-icon>
                </button>
            </td>
        </ng-container>

        <ng-container matColumnDef="address">
            <th mat-header-cell mat-sort-header *matHeaderCellDef>Address</th>
            <td mat-cell *matCellDef="let element"> {{element.address}} </td>
        </ng-container>

        <ng-container matColumnDef="custodyProvider">
            <th mat-header-cell mat-sort-header *matHeaderCellDef>Custody Provider</th>
            <td mat-cell *matCellDef="let element"> {{element.custodyProvider}} </td>
        </ng-container>

        <ng-container matColumnDef="legacyAddress">
            <th mat-header-cell *matHeaderCellDef>Legacy address</th>
            <td mat-cell *matCellDef="let element"> {{element.legacyAddress}} </td>
        </ng-container>

        <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef>Description</th>
            <td mat-cell *matCellDef="let element"> {{element.description}} </td>
        </ng-container>

        <ng-container matColumnDef="type">
            <th mat-header-cell *matHeaderCellDef>Type</th>
            <td mat-cell *matCellDef="let element"> {{element.type}} </td>
        </ng-container>

        <ng-container matColumnDef="addressFormat">
            <th mat-header-cell *matHeaderCellDef>Address format</th>
            <td mat-cell *matCellDef="let element"> {{element.addressFormat}} </td>
        </ng-container>

        <ng-container matColumnDef="assetId">
            <th mat-header-cell *matHeaderCellDef>Asset Id</th>
            <td mat-cell *matCellDef="let element"> {{element.assetId}} </td>
        </ng-container>

        <ng-container matColumnDef="originalId">
            <th mat-header-cell *matHeaderCellDef>Original Id</th>
            <td mat-cell *matCellDef="let element"> {{element.originalId}} </td>
        </ng-container>

        <ng-container matColumnDef="total">
            <th mat-header-cell *matHeaderCellDef>Total</th>
            <td mat-cell *matCellDef="let element"> {{element.total}} </td>
        </ng-container>

        <ng-container matColumnDef="available">
            <th mat-header-cell *matHeaderCellDef>Available</th>
            <td mat-cell *matCellDef="let element"> {{element.available}} </td>
        </ng-container>

        <ng-container matColumnDef="pending">
            <th mat-header-cell *matHeaderCellDef>Pending</th>
            <td mat-cell *matCellDef="let element"> {{element.pending}} </td>
        </ng-container>

        <ng-container matColumnDef="lockedAmount">
            <th mat-header-cell *matHeaderCellDef>Locked amount</th>
            <td mat-cell *matCellDef="let element"> {{element.lockedAmount}} </td>
        </ng-container>

        <ng-container matColumnDef="vaultName">
            <th mat-header-cell *matHeaderCellDef>Vault Name</th>
            <td mat-cell *matCellDef="let element"> {{element.vaultName}} </td>
        </ng-container>

        <ng-container matColumnDef="userEmail">
            <th mat-header-cell *matHeaderCellDef>User Email</th>
            <td mat-cell *matCellDef="let element"> {{element.userEmail}} </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </mat-table>
</div>

<mat-paginator [length]="walletCount" [pageSize]="pageSize" [pageSizeOptions]="[25, 50, 100]" showFirstLastButtons
    (page)="handlePage($event)">
</mat-paginator>

<ng-template *ngIf="selectedWallet" appRightPanel (panelClosed)="handleDetailsPanelClosed()">
    <app-wallet-details [permission]="permission" [wallet]="selectedWallet" [currencies]="currencyList" (save)="onSaveWallet($event)"
        (delete)="onDeleteWallet($event)" (cancel)="onCancelEdit()" (formChanged)="onEditorFormChanged($event)">
    </app-wallet-details>
</ng-template>